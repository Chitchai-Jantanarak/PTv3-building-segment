name: seg_b_geom
stage: 2
model: seg_b_geom
freeze_encoder: false
pretrained_encoder: checkpoints/mae/best.pt
input_filter: building_only

masking:
  type: structured
  targets: [wall, roof]

loss:
  type: chamfer

optimizer:
  type: adamw
  encoder_lr: 2e-6   # 1/50 of head_lr â€” chamfer gradients are large, encoder needs extra protection
  head_lr: 1e-4
  weight_decay: 0.05

scheduler:
  type: cosine
  warmup_epochs: 10

epochs: 150
batch_size: 1
