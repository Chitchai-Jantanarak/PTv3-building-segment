name: seg_a
stage: 1
model: seg_a
freeze_encoder: false
pretrained_encoder: checkpoints/mae/best.pt
# Set true to concatenate RGB (3ch) to encoder latent before the head.
# Encoder stays 4-channel so MAE weights load cleanly.
use_rgb: false

loss:
  type: focal
  gamma: 2.0
  weight_method: sqrt_inverse_freq
  building_boost: 1.5
  building_class: 2

optimizer:
  type: adamw
  encoder_lr: 2e-5
  head_lr: 2e-4
  weight_decay: 0.01

scheduler:
  type: cosine
  warmup_epochs: 3

epochs: 150
early_stopping_patience: 15
batch_size: 2
